//---------------------------------------------------------------------
// <autogenerated>
//
//     Generated by Message Compiler (mc.exe)
//
//     Copyright (c) Microsoft Corporation. All Rights Reserved.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </autogenerated>
//---------------------------------------------------------------------

    using System;
    using System.Collections.Generic;
    using System.Text;
    using System.Diagnostics;
    using System.Diagnostics.Eventing;
    using Microsoft.Win32;
    using System.Runtime.InteropServices;
    using System.Security.Principal;






namespace ProviderManifest
{

    public static class ITCompanionProvider
    {
        //
        // Provider "ITCompanion-EventProvider" event count = 29
        //

        internal static EventProviderVersionTwo m_provider = new EventProviderVersionTwo(new Guid("78ec9516-8bff-4a76-b972-f3e589277beb"));
        //
        // Task :  eventGUIDs
        //

        //
        // Event Descriptors
        //
        private static EventDescriptor HOST_OPS;
        private static EventDescriptor HOST_ERR;
        private static EventDescriptor GeneralException;
        private static EventDescriptor HostStarted;
        private static EventDescriptor HostStopping;
        private static EventDescriptor HostRecovered;
        private static EventDescriptor DetectorInitialized;
        private static EventDescriptor DetectorInitializationFailed;
        private static EventDescriptor DetectorHeartbeat;
        private static EventDescriptor DetectorDeployed;
        private static EventDescriptor DetectorDeploymentFailed;
        private static EventDescriptor DetectorLoaded;
        private static EventDescriptor DetectorLoadedError;
        private static EventDescriptor SecurityAccessEvaluated;
        private static EventDescriptor SecurityAccessDenied;
        private static EventDescriptor ValidationRunSummary;
        private static EventDescriptor DeploymentStarted;
        private static EventDescriptor DeploymentCompleted;
        private static EventDescriptor DeploymentFailed;
        private static EventDescriptor VersionSnapshotCreated;
        private static EventDescriptor StorageOperationCompleted;
        private static EventDescriptor StorageOperationFailed;
        private static EventDescriptor SelfHealActionAttempted;
        private static EventDescriptor SelfHealActionResult;
        private static EventDescriptor AuditActionRecorded;
        private static EventDescriptor AIInferenceCompleted;
        private static EventDescriptor PerfMetricCollected;
        private static EventDescriptor HostHealthSample;
        private static EventDescriptor PolicyChanged;

        static ITCompanionProvider()
        {
            unchecked
            {
                HOST_OPS = new EventDescriptor(0x898, 0x0, 0x10, 0x4, 0x0, 0x4, (long)0x8000000000000000);
                HOST_ERR = new EventDescriptor(0x8a2, 0x0, 0x10, 0x2, 0x10, 0x4, (long)0x8000000000000400);
                GeneralException = new EventDescriptor(0x8ca, 0x0, 0x10, 0x2, 0x10, 0x4, (long)0x8000000000000400);
                HostStarted = new EventDescriptor(0x899, 0x0, 0x10, 0x4, 0x11, 0x4, (long)0x8000000000000000);
                HostStopping = new EventDescriptor(0x89a, 0x0, 0x10, 0x4, 0x12, 0x4, (long)0x8000000000000000);
                HostRecovered = new EventDescriptor(0x8a3, 0x0, 0x10, 0x3, 0x13, 0x4, (long)0x8000000000000000);
                DetectorInitialized = new EventDescriptor(0x8fd, 0x0, 0x10, 0x4, 0xc, 0x7, (long)0x8000000000000004);
                DetectorInitializationFailed = new EventDescriptor(0x8fe, 0x0, 0x10, 0x2, 0x14, 0x7, (long)0x8000000000000404);
                DetectorHeartbeat = new EventDescriptor(0x8ff, 0x0, 0x10, 0x4, 0xf, 0x7, (long)0x8000000000000084);
                DetectorDeployed = new EventDescriptor(0x906, 0x0, 0x10, 0x4, 0xe, 0x8, (long)0x800000000000000c);
                DetectorDeploymentFailed = new EventDescriptor(0x907, 0x0, 0x10, 0x2, 0x14, 0x8, (long)0x800000000000040c);
                DetectorLoaded = new EventDescriptor(0x8fc, 0x0, 0x10, 0x4, 0x13, 0x2, (long)0x8000000000000004);
                DetectorLoadedError = new EventDescriptor(0x910, 0x0, 0x10, 0x2, 0x14, 0x2, (long)0x8000000000000404);
                SecurityAccessEvaluated = new EventDescriptor(0x3e8, 0x0, 0x10, 0x4, 0x1a, 0x9, (long)0x8000000000000001);
                SecurityAccessDenied = new EventDescriptor(0x3e9, 0x0, 0x10, 0x3, 0x1b, 0x9, (long)0x8000000000000001);
                ValidationRunSummary = new EventDescriptor(0xc1c, 0x0, 0x10, 0x4, 0x1c, 0xa, (long)0x8000000000001000);
                DeploymentStarted = new EventDescriptor(0xfa0, 0x0, 0x10, 0x4, 0x11, 0xb, (long)0x8000000000000008);
                DeploymentCompleted = new EventDescriptor(0xfa1, 0x0, 0x10, 0x4, 0x13, 0xb, (long)0x8000000000000008);
                DeploymentFailed = new EventDescriptor(0xfa2, 0x0, 0x10, 0x2, 0x14, 0xb, (long)0x8000000000000408);
                VersionSnapshotCreated = new EventDescriptor(0x1388, 0x0, 0x10, 0x4, 0x13, 0xc, (long)0x8000000000000000);
                StorageOperationCompleted = new EventDescriptor(0x1770, 0x0, 0x10, 0x4, 0x13, 0xd, (long)0x8000000000000010);
                StorageOperationFailed = new EventDescriptor(0x1771, 0x0, 0x10, 0x2, 0x14, 0xd, (long)0x8000000000000010);
                SelfHealActionAttempted = new EventDescriptor(0x1b58, 0x0, 0x10, 0x4, 0x11, 0xe, (long)0x8000000000000200);
                SelfHealActionResult = new EventDescriptor(0x1b59, 0x0, 0x10, 0x4, 0x13, 0xe, (long)0x8000000000000200);
                AuditActionRecorded = new EventDescriptor(0x1f40, 0x0, 0x10, 0x4, 0x1b, 0xf, (long)0x8000000000000020);
                AIInferenceCompleted = new EventDescriptor(0x1fa4, 0x0, 0x10, 0x4, 0x13, 0x11, (long)0x8000000000000100);
                PerfMetricCollected = new EventDescriptor(0x2008, 0x0, 0x10, 0x4, 0x13, 0x10, (long)0x8000000000000040);
                HostHealthSample = new EventDescriptor(0x206c, 0x0, 0x10, 0x4, 0xf, 0x13, (long)0x8000000000000080);
                PolicyChanged = new EventDescriptor(0x20d0, 0x0, 0x10, 0x4, 0x1b, 0x12, (long)0x8000000000000800);
            }
        }

        //
        // Event method for HOST_OPS
        //
        public static bool EventWriteHOST_OPS(string Message)
        {
            return m_provider.WriteEvent(ref HOST_OPS, Message);
        }

        //
        // Event method for HOST_ERR
        //
        public static bool EventWriteHOST_ERR(string Message)
        {
            return m_provider.WriteEvent(ref HOST_ERR, Message);
        }

        //
        // Event method for GeneralException
        //
        public static bool EventWriteGeneralException(string Message, string ExceptionMsg, string StackTrace)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateException1(ref GeneralException, Message, ExceptionMsg, StackTrace);
        }

        //
        // Event method for HostStarted
        //
        public static bool EventWriteHostStarted(string HostVersion, uint UptimeSec, string CorrelationId)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateHostLifecycle(ref HostStarted, HostVersion, UptimeSec, CorrelationId);
        }

        //
        // Event method for HostStopping
        //
        public static bool EventWriteHostStopping(string HostVersion, uint UptimeSec, string CorrelationId)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateHostLifecycle(ref HostStopping, HostVersion, UptimeSec, CorrelationId);
        }

        //
        // Event method for HostRecovered
        //
        public static bool EventWriteHostRecovered(string HostVersion, uint UptimeSec, string CorrelationId)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateHostLifecycle(ref HostRecovered, HostVersion, UptimeSec, CorrelationId);
        }

        //
        // Event method for DetectorInitialized
        //
        public static bool EventWriteDetectorInitialized(string DetectorID, string Name, string Version, uint LoadDurationMs)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateDetectorLifecycle(ref DetectorInitialized, DetectorID, Name, Version, LoadDurationMs);
        }

        //
        // Event method for DetectorInitializationFailed
        //
        public static bool EventWriteDetectorInitializationFailed(string DetectorID, string Name, string Version, uint ErrorCode, string ExceptionMsg)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateDetectorFailure(ref DetectorInitializationFailed, DetectorID, Name, Version, ErrorCode, ExceptionMsg);
        }

        //
        // Event method for DetectorHeartbeat
        //
        public static bool EventWriteDetectorHeartbeat(string DetectorID, string Name, string Version, float CpuPct, uint MemoryMB, uint PendingTasks)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateDetectorHeartbeat(ref DetectorHeartbeat, DetectorID, Name, Version, CpuPct, MemoryMB, PendingTasks);
        }

        //
        // Event method for DetectorDeployed
        //
        public static bool EventWriteDetectorDeployed(string DeploymentId, string Target, string Initiator, string CorrelationId)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateDeploymentOperation(ref DetectorDeployed, DeploymentId, Target, Initiator, CorrelationId);
        }

        //
        // Event method for DetectorDeploymentFailed
        //
        public static bool EventWriteDetectorDeploymentFailed(string DeploymentId, string Target, uint ErrorCode, string ExceptionMsg)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateDeploymentFailure(ref DetectorDeploymentFailed, DeploymentId, Target, ErrorCode, ExceptionMsg);
        }

        //
        // Event method for DetectorLoaded
        //
        public static bool EventWriteDetectorLoaded(string DetectorID, string DetectorName, string DetectorDescription, string Author)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateDetectorIdent(ref DetectorLoaded, DetectorID, DetectorName, DetectorDescription, Author);
        }

        //
        // Event method for DetectorLoadedError
        //
        public static bool EventWriteDetectorLoadedError(string DetectorID, string DetectorName, string DetectorDescription, string Author)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateDetectorIdent(ref DetectorLoadedError, DetectorID, DetectorName, DetectorDescription, Author);
        }

        //
        // Event method for SecurityAccessEvaluated
        //
        public static bool EventWriteSecurityAccessEvaluated(string Principal, string Action, string Resource, string Decision, string Reason)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateSecurityEvaluation(ref SecurityAccessEvaluated, Principal, Action, Resource, Decision, Reason);
        }

        //
        // Event method for SecurityAccessDenied
        //
        public static bool EventWriteSecurityAccessDenied(string Principal, string Action, string Resource, string Decision, string Reason)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateSecurityEvaluation(ref SecurityAccessDenied, Principal, Action, Resource, Decision, Reason);
        }

        //
        // Event method for ValidationRunSummary
        //
        public static bool EventWriteValidationRunSummary(string RuleSetId, uint Passed, uint Failed, uint Warnings, uint DurationMs)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateValidationSummary(ref ValidationRunSummary, RuleSetId, Passed, Failed, Warnings, DurationMs);
        }

        //
        // Event method for DeploymentStarted
        //
        public static bool EventWriteDeploymentStarted(string DeploymentId, string Target, string Initiator, string CorrelationId)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateDeploymentOperation(ref DeploymentStarted, DeploymentId, Target, Initiator, CorrelationId);
        }

        //
        // Event method for DeploymentCompleted
        //
        public static bool EventWriteDeploymentCompleted(string DeploymentId, string Target, uint DurationMs, string Outcome)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateDeploymentResult(ref DeploymentCompleted, DeploymentId, Target, DurationMs, Outcome);
        }

        //
        // Event method for DeploymentFailed
        //
        public static bool EventWriteDeploymentFailed(string DeploymentId, string Target, uint ErrorCode, string ExceptionMsg)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateDeploymentFailure(ref DeploymentFailed, DeploymentId, Target, ErrorCode, ExceptionMsg);
        }

        //
        // Event method for VersionSnapshotCreated
        //
        public static bool EventWriteVersionSnapshotCreated(string SnapshotId, string BaselineId, uint ChangedItems)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateVersionSnapshot(ref VersionSnapshotCreated, SnapshotId, BaselineId, ChangedItems);
        }

        //
        // Event method for StorageOperationCompleted
        //
        public static bool EventWriteStorageOperationCompleted(string Operation, string Entity, string Key, uint DurationMs, uint Rows)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateStorageOperation(ref StorageOperationCompleted, Operation, Entity, Key, DurationMs, Rows);
        }

        //
        // Event method for StorageOperationFailed
        //
        public static bool EventWriteStorageOperationFailed(string Operation, string Entity, string Key, uint ErrorCode, string ExceptionMsg)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateStorageFailure(ref StorageOperationFailed, Operation, Entity, Key, ErrorCode, ExceptionMsg);
        }

        //
        // Event method for SelfHealActionAttempted
        //
        public static bool EventWriteSelfHealActionAttempted(string RuleId, string ActionTaken, string CorrelationId)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateSelfHealAction(ref SelfHealActionAttempted, RuleId, ActionTaken, CorrelationId);
        }

        //
        // Event method for SelfHealActionResult
        //
        public static bool EventWriteSelfHealActionResult(string RuleId, string ActionTaken, bool Success, uint DurationMs)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateSelfHealResult(ref SelfHealActionResult, RuleId, ActionTaken, Success, DurationMs);
        }

        //
        // Event method for AuditActionRecorded
        //
        public static bool EventWriteAuditActionRecorded(string Actor, string ActionType, string Target, string CorrelationId, string Outcome)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateAuditAction(ref AuditActionRecorded, Actor, ActionType, Target, CorrelationId, Outcome);
        }

        //
        // Event method for AIInferenceCompleted
        //
        public static bool EventWriteAIInferenceCompleted(string Model, string ModelVersion, uint InputTokens, uint OutputTokens, uint LatencyMs, float Confidence)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateAIInference(ref AIInferenceCompleted, Model, ModelVersion, InputTokens, OutputTokens, LatencyMs, Confidence);
        }

        //
        // Event method for PerfMetricCollected
        //
        public static bool EventWritePerfMetricCollected(string Component, string Metric, float Value, string Unit, float Threshold, bool Breach)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplatePerformanceMetric(ref PerfMetricCollected, Component, Metric, Value, Unit, Threshold, Breach);
        }

        //
        // Event method for HostHealthSample
        //
        public static bool EventWriteHostHealthSample(float CpuPct, float MemoryPct, uint ThreadCount, uint HandleCount, uint GcGen0, uint GcGen1, uint GcGen2)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplateHostHealth(ref HostHealthSample, CpuPct, MemoryPct, ThreadCount, HandleCount, GcGen0, GcGen1, GcGen2);
        }

        //
        // Event method for PolicyChanged
        //
        public static bool EventWritePolicyChanged(string PolicyId, string OldValue, string NewValue, string ChangedBy, string CorrelationId)
        {
            if (!m_provider.IsEnabled())
            {
                return true;
            }

            return m_provider.TemplatePolicyChange(ref PolicyChanged, PolicyId, OldValue, NewValue, ChangedBy, CorrelationId);
        }
    }

    internal class EventProviderVersionTwo : EventProvider
    {
         internal EventProviderVersionTwo(Guid id)
                : base(id)
         {}

        [StructLayout(LayoutKind.Explicit, Size = 16)]
        private struct EventData
        {
            [FieldOffset(0)]
            internal UInt64 DataPointer;
            [FieldOffset(8)]
            internal uint Size;
            [FieldOffset(12)]
            internal int Reserved;
        }

        internal unsafe bool TemplateAIInference(
            ref EventDescriptor eventDescriptor,
            string Model,
            string ModelVersion,
            uint InputTokens,
            uint OutputTokens,
            uint LatencyMs,
            float Confidence
            )
        {
            int argumentCount = 6;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(Model.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(ModelVersion.Length + 1)*sizeof(char);

                userDataPtr[2].DataPointer = (UInt64)(&InputTokens);
                userDataPtr[2].Size = (uint)(sizeof(int)  );

                userDataPtr[3].DataPointer = (UInt64)(&OutputTokens);
                userDataPtr[3].Size = (uint)(sizeof(int)  );

                userDataPtr[4].DataPointer = (UInt64)(&LatencyMs);
                userDataPtr[4].Size = (uint)(sizeof(int)  );

                userDataPtr[5].DataPointer = (UInt64)(&Confidence);
                userDataPtr[5].Size = (uint)(sizeof(float)  );

                fixed (char* a0 = Model, a1 = ModelVersion)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateAuditAction(
            ref EventDescriptor eventDescriptor,
            string Actor,
            string ActionType,
            string Target,
            string CorrelationId,
            string Outcome
            )
        {
            int argumentCount = 5;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(Actor.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(ActionType.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(Target.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[3].Size = (uint)(CorrelationId.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[4].Size = (uint)(Outcome.Length + 1)*sizeof(char);

                fixed (char* a0 = Actor, a1 = ActionType, a2 = Target, a3 = CorrelationId, a4 = Outcome)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    userDataPtr[3].DataPointer = (ulong)a3;
                    userDataPtr[4].DataPointer = (ulong)a4;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateDeploymentFailure(
            ref EventDescriptor eventDescriptor,
            string DeploymentId,
            string Target,
            uint ErrorCode,
            string ExceptionMsg
            )
        {
            int argumentCount = 4;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(DeploymentId.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(Target.Length + 1)*sizeof(char);

                userDataPtr[2].DataPointer = (UInt64)(&ErrorCode);
                userDataPtr[2].Size = (uint)(sizeof(int)  );

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[3].Size = (uint)(ExceptionMsg.Length + 1)*sizeof(char);

                fixed (char* a0 = DeploymentId, a1 = Target, a2 = ExceptionMsg)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[3].DataPointer = (ulong)a2;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateDeploymentOperation(
            ref EventDescriptor eventDescriptor,
            string DeploymentId,
            string Target,
            string Initiator,
            string CorrelationId
            )
        {
            int argumentCount = 4;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(DeploymentId.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(Target.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(Initiator.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[3].Size = (uint)(CorrelationId.Length + 1)*sizeof(char);

                fixed (char* a0 = DeploymentId, a1 = Target, a2 = Initiator, a3 = CorrelationId)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    userDataPtr[3].DataPointer = (ulong)a3;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateDeploymentResult(
            ref EventDescriptor eventDescriptor,
            string DeploymentId,
            string Target,
            uint DurationMs,
            string Outcome
            )
        {
            int argumentCount = 4;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(DeploymentId.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(Target.Length + 1)*sizeof(char);

                userDataPtr[2].DataPointer = (UInt64)(&DurationMs);
                userDataPtr[2].Size = (uint)(sizeof(int)  );

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[3].Size = (uint)(Outcome.Length + 1)*sizeof(char);

                fixed (char* a0 = DeploymentId, a1 = Target, a2 = Outcome)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[3].DataPointer = (ulong)a2;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateDetectorFailure(
            ref EventDescriptor eventDescriptor,
            string DetectorID,
            string Name,
            string Version,
            uint ErrorCode,
            string ExceptionMsg
            )
        {
            int argumentCount = 5;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(DetectorID.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(Name.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(Version.Length + 1)*sizeof(char);

                userDataPtr[3].DataPointer = (UInt64)(&ErrorCode);
                userDataPtr[3].Size = (uint)(sizeof(int)  );

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[4].Size = (uint)(ExceptionMsg.Length + 1)*sizeof(char);

                fixed (char* a0 = DetectorID, a1 = Name, a2 = Version, a3 = ExceptionMsg)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    userDataPtr[4].DataPointer = (ulong)a3;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateDetectorHeartbeat(
            ref EventDescriptor eventDescriptor,
            string DetectorID,
            string Name,
            string Version,
            float CpuPct,
            uint MemoryMB,
            uint PendingTasks
            )
        {
            int argumentCount = 6;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(DetectorID.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(Name.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(Version.Length + 1)*sizeof(char);

                userDataPtr[3].DataPointer = (UInt64)(&CpuPct);
                userDataPtr[3].Size = (uint)(sizeof(float)  );

                userDataPtr[4].DataPointer = (UInt64)(&MemoryMB);
                userDataPtr[4].Size = (uint)(sizeof(int)  );

                userDataPtr[5].DataPointer = (UInt64)(&PendingTasks);
                userDataPtr[5].Size = (uint)(sizeof(int)  );

                fixed (char* a0 = DetectorID, a1 = Name, a2 = Version)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateDetectorIdent(
            ref EventDescriptor eventDescriptor,
            string DetectorID,
            string DetectorName,
            string DetectorDescription,
            string Author
            )
        {
            int argumentCount = 4;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(DetectorID.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(DetectorName.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(DetectorDescription.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[3].Size = (uint)(Author.Length + 1)*sizeof(char);

                fixed (char* a0 = DetectorID, a1 = DetectorName, a2 = DetectorDescription, a3 = Author)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    userDataPtr[3].DataPointer = (ulong)a3;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateDetectorLifecycle(
            ref EventDescriptor eventDescriptor,
            string DetectorID,
            string Name,
            string Version,
            uint LoadDurationMs
            )
        {
            int argumentCount = 4;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(DetectorID.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(Name.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(Version.Length + 1)*sizeof(char);

                userDataPtr[3].DataPointer = (UInt64)(&LoadDurationMs);
                userDataPtr[3].Size = (uint)(sizeof(int)  );

                fixed (char* a0 = DetectorID, a1 = Name, a2 = Version)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateException1(
            ref EventDescriptor eventDescriptor,
            string Message,
            string ExceptionMsg,
            string StackTrace
            )
        {
            int argumentCount = 3;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(Message.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(ExceptionMsg.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(StackTrace.Length + 1)*sizeof(char);

                fixed (char* a0 = Message, a1 = ExceptionMsg, a2 = StackTrace)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateHostHealth(
            ref EventDescriptor eventDescriptor,
            float CpuPct,
            float MemoryPct,
            uint ThreadCount,
            uint HandleCount,
            uint GcGen0,
            uint GcGen1,
            uint GcGen2
            )
        {
            int argumentCount = 7;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                userDataPtr[0].DataPointer = (UInt64)(&CpuPct);
                userDataPtr[0].Size = (uint)(sizeof(float)  );

                userDataPtr[1].DataPointer = (UInt64)(&MemoryPct);
                userDataPtr[1].Size = (uint)(sizeof(float)  );

                userDataPtr[2].DataPointer = (UInt64)(&ThreadCount);
                userDataPtr[2].Size = (uint)(sizeof(int)  );

                userDataPtr[3].DataPointer = (UInt64)(&HandleCount);
                userDataPtr[3].Size = (uint)(sizeof(int)  );

                userDataPtr[4].DataPointer = (UInt64)(&GcGen0);
                userDataPtr[4].Size = (uint)(sizeof(int)  );

                userDataPtr[5].DataPointer = (UInt64)(&GcGen1);
                userDataPtr[5].Size = (uint)(sizeof(int)  );

                userDataPtr[6].DataPointer = (UInt64)(&GcGen2);
                userDataPtr[6].Size = (uint)(sizeof(int)  );

                status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
            }

            return status;
        }

        internal unsafe bool TemplateHostLifecycle(
            ref EventDescriptor eventDescriptor,
            string HostVersion,
            uint UptimeSec,
            string CorrelationId
            )
        {
            int argumentCount = 3;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(HostVersion.Length + 1)*sizeof(char);

                userDataPtr[1].DataPointer = (UInt64)(&UptimeSec);
                userDataPtr[1].Size = (uint)(sizeof(int)  );

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(CorrelationId.Length + 1)*sizeof(char);

                fixed (char* a0 = HostVersion, a1 = CorrelationId)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[2].DataPointer = (ulong)a1;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplatePerformanceMetric(
            ref EventDescriptor eventDescriptor,
            string Component,
            string Metric,
            float Value,
            string Unit,
            float Threshold,
            bool Breach
            )
        {
            int argumentCount = 6;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(Component.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(Metric.Length + 1)*sizeof(char);

                userDataPtr[2].DataPointer = (UInt64)(&Value);
                userDataPtr[2].Size = (uint)(sizeof(float)  );

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[3].Size = (uint)(Unit.Length + 1)*sizeof(char);

                userDataPtr[4].DataPointer = (UInt64)(&Threshold);
                userDataPtr[4].Size = (uint)(sizeof(float)  );

                int BreachInt = Breach ? 1 : 0;
                userDataPtr[5].DataPointer = (UInt64)(&BreachInt);
                userDataPtr[5].Size = (uint)(sizeof(int));

                fixed (char* a0 = Component, a1 = Metric, a2 = Unit)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[3].DataPointer = (ulong)a2;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplatePolicyChange(
            ref EventDescriptor eventDescriptor,
            string PolicyId,
            string OldValue,
            string NewValue,
            string ChangedBy,
            string CorrelationId
            )
        {
            int argumentCount = 5;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(PolicyId.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(OldValue.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(NewValue.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[3].Size = (uint)(ChangedBy.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[4].Size = (uint)(CorrelationId.Length + 1)*sizeof(char);

                fixed (char* a0 = PolicyId, a1 = OldValue, a2 = NewValue, a3 = ChangedBy, a4 = CorrelationId)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    userDataPtr[3].DataPointer = (ulong)a3;
                    userDataPtr[4].DataPointer = (ulong)a4;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateSecurityEvaluation(
            ref EventDescriptor eventDescriptor,
            string Principal,
            string Action,
            string Resource,
            string Decision,
            string Reason
            )
        {
            int argumentCount = 5;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(Principal.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(Action.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(Resource.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[3].Size = (uint)(Decision.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[4].Size = (uint)(Reason.Length + 1)*sizeof(char);

                fixed (char* a0 = Principal, a1 = Action, a2 = Resource, a3 = Decision, a4 = Reason)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    userDataPtr[3].DataPointer = (ulong)a3;
                    userDataPtr[4].DataPointer = (ulong)a4;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateSelfHealAction(
            ref EventDescriptor eventDescriptor,
            string RuleId,
            string ActionTaken,
            string CorrelationId
            )
        {
            int argumentCount = 3;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(RuleId.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(ActionTaken.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(CorrelationId.Length + 1)*sizeof(char);

                fixed (char* a0 = RuleId, a1 = ActionTaken, a2 = CorrelationId)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateSelfHealResult(
            ref EventDescriptor eventDescriptor,
            string RuleId,
            string ActionTaken,
            bool Success,
            uint DurationMs
            )
        {
            int argumentCount = 4;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(RuleId.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(ActionTaken.Length + 1)*sizeof(char);

                int SuccessInt = Success ? 1 : 0;
                userDataPtr[2].DataPointer = (UInt64)(&SuccessInt);
                userDataPtr[2].Size = (uint)(sizeof(int));

                userDataPtr[3].DataPointer = (UInt64)(&DurationMs);
                userDataPtr[3].Size = (uint)(sizeof(int)  );

                fixed (char* a0 = RuleId, a1 = ActionTaken)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateStorageFailure(
            ref EventDescriptor eventDescriptor,
            string Operation,
            string Entity,
            string Key,
            uint ErrorCode,
            string ExceptionMsg
            )
        {
            int argumentCount = 5;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(Operation.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(Entity.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(Key.Length + 1)*sizeof(char);

                userDataPtr[3].DataPointer = (UInt64)(&ErrorCode);
                userDataPtr[3].Size = (uint)(sizeof(int)  );

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[4].Size = (uint)(ExceptionMsg.Length + 1)*sizeof(char);

                fixed (char* a0 = Operation, a1 = Entity, a2 = Key, a3 = ExceptionMsg)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    userDataPtr[4].DataPointer = (ulong)a3;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateStorageOperation(
            ref EventDescriptor eventDescriptor,
            string Operation,
            string Entity,
            string Key,
            uint DurationMs,
            uint Rows
            )
        {
            int argumentCount = 5;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(Operation.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(Entity.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[2].Size = (uint)(Key.Length + 1)*sizeof(char);

                userDataPtr[3].DataPointer = (UInt64)(&DurationMs);
                userDataPtr[3].Size = (uint)(sizeof(int)  );

                userDataPtr[4].DataPointer = (UInt64)(&Rows);
                userDataPtr[4].Size = (uint)(sizeof(int)  );

                fixed (char* a0 = Operation, a1 = Entity, a2 = Key)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    userDataPtr[2].DataPointer = (ulong)a2;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateValidationSummary(
            ref EventDescriptor eventDescriptor,
            string RuleSetId,
            uint Passed,
            uint Failed,
            uint Warnings,
            uint DurationMs
            )
        {
            int argumentCount = 5;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(RuleSetId.Length + 1)*sizeof(char);

                userDataPtr[1].DataPointer = (UInt64)(&Passed);
                userDataPtr[1].Size = (uint)(sizeof(int)  );

                userDataPtr[2].DataPointer = (UInt64)(&Failed);
                userDataPtr[2].Size = (uint)(sizeof(int)  );

                userDataPtr[3].DataPointer = (UInt64)(&Warnings);
                userDataPtr[3].Size = (uint)(sizeof(int)  );

                userDataPtr[4].DataPointer = (UInt64)(&DurationMs);
                userDataPtr[4].Size = (uint)(sizeof(int)  );

                fixed (char* a0 = RuleSetId)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }

        internal unsafe bool TemplateVersionSnapshot(
            ref EventDescriptor eventDescriptor,
            string SnapshotId,
            string BaselineId,
            uint ChangedItems
            )
        {
            int argumentCount = 3;
            bool status = true;

            if (IsEnabled(eventDescriptor.Level, eventDescriptor.Keywords))
            {
                byte* userData = stackalloc byte[sizeof(EventData) * argumentCount];
                EventData* userDataPtr = (EventData*)userData;

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[0].Size = (uint)(SnapshotId.Length + 1)*sizeof(char);

                // Value is a nul-terminated string (assume no embedded nuls):
                userDataPtr[1].Size = (uint)(BaselineId.Length + 1)*sizeof(char);

                userDataPtr[2].DataPointer = (UInt64)(&ChangedItems);
                userDataPtr[2].Size = (uint)(sizeof(int)  );

                fixed (char* a0 = SnapshotId, a1 = BaselineId)
                {
                    userDataPtr[0].DataPointer = (ulong)a0;
                    userDataPtr[1].DataPointer = (ulong)a1;
                    status = WriteEvent(ref eventDescriptor, argumentCount, (IntPtr)(userData));
                }
            }

            return status;
        }
    }
}
