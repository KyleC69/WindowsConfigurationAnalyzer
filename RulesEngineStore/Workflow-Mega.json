{
  "$schema": "https://yourproject.org/schemas/workflow.schema.json",
  "WorkflowName": "FullSpectrumWindowsConfigValidation",
  "SchemaVersion": "1.0",
  "Author": "Test Suite",
  "Constraints": {
    "RunSequentially": false,
    "StopOnFailure": false,
    "Timeout": "00:30:00"
  },
  "ConfigSets": [
    {
      "ConfigSetName": "RegistryPolicies",
      "Rules": [
        {
          "RuleName": "UACEnabled",
          "Provider": "Registry",
          "Parameters": {
            "KeyPath": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System",
            "ValueName": "EnableLUA"
          },
          "Condition": { "Operator": "Equals", "Expected": 1 },
          "Severity": 7,
          "Message": "User Account Control must be enabled"
        },
        {
          "RuleName": "PasswordComplexity",
          "Provider": "Registry",
          "Parameters": {
            "KeyPath": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa",
            "ValueName": "PasswordComplexity"
          },
          "Condition": { "Operator": "Equals", "Expected": 1 },
          "Severity": 8,
          "Message": "Password complexity must be enforced"
        }
      ]
    },
    {
      "ConfigSetName": "WMIServiceChecks",
      "Rules": [
        {
          "RuleName": "FirewallServiceRunning",
          "Provider": "WMI",
          "Parameters": {
            "Class": "Win32_Service",
            "Property": "Started",
            "Filter": "Name='MpsSvc'"
          },
          "Condition": { "Operator": "Equals", "Expected": true },
          "Severity": 8,
          "Message": "Windows Firewall service must be running"
        },
        {
          "RuleName": "WindowsUpdateServiceRunning",
          "Provider": "WMI",
          "Parameters": {
            "Class": "Win32_Service",
            "Property": "Started",
            "Filter": "Name='wuauserv'"
          },
          "Condition": { "Operator": "Equals", "Expected": true },
          "Severity": 9,
          "Message": "Windows Update service must be running"
        }
      ]
    },
    {
      "ConfigSetName": "FileSystemChecks",
      "Rules": [
        {
          "RuleName": "HostsFileExists",
          "Provider": "FileSystem",
          "Parameters": { "Path": "C:\\Windows\\System32\\drivers\\etc\\hosts" },
          "Condition": { "Operator": "Exists" },
          "Severity": 4,
          "Message": "Hosts file must exist"
        },
        {
          "RuleName": "PageFileExists",
          "Provider": "FileSystem",
          "Parameters": { "Path": "C:\\pagefile.sys" },
          "Condition": { "Operator": "Exists" },
          "Severity": 6,
          "Message": "Pagefile must exist"
        }
      ]
    },
    {
      "ConfigSetName": "ACLChecks",
      "Rules": [
        {
          "RuleName": "System32Restricted",
          "Provider": "ACL",
          "Parameters": { "Path": "C:\\Windows\\System32" },
          "Condition": { "Operator": "Contains", "Expected": "SYSTEM" },
          "Severity": 9,
          "Message": "System32 folder must be restricted to SYSTEM account"
        },
        {
          "RuleName": "SAMFileRestricted",
          "Provider": "ACL",
          "Parameters": { "Path": "C:\\Windows\\System32\\config\\SAM" },
          "Condition": { "Operator": "Contains", "Expected": "Administrators" },
          "Severity": 10,
          "Message": "SAM file must be restricted to Administrators"
        }
      ]
    },
    {
      "ConfigSetName": "EventLogChecks",
      "Rules": [
        {
          "RuleName": "SecurityLogExists",
          "Provider": "EventLog",
          "Parameters": { "LogName": "Security" },
          "Condition": { "Operator": "Exists" },
          "Severity": 10,
          "Message": "Security log must exist"
        },
        {
          "RuleName": "SystemLogRetention",
          "Provider": "EventLog",
          "Parameters": { "LogName": "System" },
          "Condition": { "Operator": "GreaterThan", "Expected": 7 },
          "Severity": 5,
          "Message": "System log retention must be greater than 7 days"
        }
      ]
    },
    {
      "ConfigSetName": "IdentityChecks",
      "Rules": [
        {
          "RuleName": "GuestAccountDisabled",
          "Provider": "WMI",
          "Parameters": {
            "Class": "Win32_UserAccount",
            "Property": "Disabled",
            "Filter": "Name='Guest'"
          },
          "Condition": { "Operator": "Equals", "Expected": true },
          "Severity": 9,
          "Message": "Guest account must be disabled"
        },
        {
          "RuleName": "AdminGroupMembership",
          "Provider": "WMI",
          "Parameters": {
            "Class": "Win32_GroupUser",
            "Property": "GroupComponent",
            "Filter": "Group='Administrators'"
          },
          "Condition": { "Operator": "Contains", "Expected": "Administrator" },
          "Severity": 8,
          "Message": "Administrator group must contain Administrator account"
        }
      ]
    },
    {
      "ConfigSetName": "NetworkingChecks",
      "Rules": [
        {
          "RuleName": "ProxyDisabled",
          "Provider": "Registry",
          "Parameters": {
            "KeyPath": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
            "ValueName": "ProxyEnable"
          },
          "Condition": { "Operator": "Equals", "Expected": 0 },
          "Severity": 6,
          "Message": "Proxy must be disabled unless explicitly required"
        },
        {
          "RuleName": "DNSClientRunning",
          "Provider": "WMI",
          "Parameters": {
            "Class": "Win32_Service",
            "Property": "Started",
            "Filter": "Name='Dnscache'"
          },
          "Condition": { "Operator": "Equals", "Expected": true },
          "Severity": 7,
          "Message": "DNS Client service must be running"
        }
      ]
    },
    {
      "ConfigSetName": "DeviceAndDriverChecks",
      "Rules": [
        {
          "RuleName": "BitLockerEnabled",
          "Provider": "WMI",
          "Parameters": {
            "Class": "Win32_EncryptableVolume",
            "Property": "ProtectionStatus",
            "Filter": "DriveLetter='C:'"
          },
          "Condition": { "Operator": "Equals", "Expected": 1 },
          "Severity": 10,
          "Message": "BitLocker must be enabled on system drive"
        },
        {
          "RuleName": "SecureBootEnabled",
          "Provider": "WMI",
          "Parameters": {
            "Class": "MS_SecureBoot",
            "Property": "Enabled"
          },
          "Condition": { "Operator": "Equals", "Expected": true },
          "Severity": 9,
          "Message": "Secure Boot must be enabled"
        }
      ]
    },
    {
      "ConfigSetName": "PerformanceChecks",
      "Rules": [
        {
          "RuleName": "PowerPlanBalanced",
          "Provider": "WMI",
          "Parameters": {
            "Class": "Win32_PowerPlan",
            "Property": "ElementName",
            "Filter": "IsActive=true"
          },
          "Condition": { "Operator": "Equals", "Expected": "Balanced" },
          "Severity": 4,
          "Message": "Balanced power plan must be active"
        }
      ]
    },
    {
      "ConfigSetName": "AppControlChecks",
      "Rules": [
        {
          "RuleName": "AppLockerPolicyExists",
          "Provider": "FileSystem",
          "Parameters": { "Path": "C:\\Windows\\System32\\AppLocker\\AppLocker.xml" },
          "Condition": { "Operator": "Exists" },
          "Severity": 8,
          "Message": "AppLocker policy must exist"
        }
      ]
    },
    {
      "ConfigSetName": "EnvironmentVariableChecks",
      "Rules": [
        {
          "RuleName": "PathVariableClean",
          "Provider": "Registry",
          "Parameters": {
            "KeyPath": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment",
            "ValueName": "Path"
          },
          "Condition": { "Operator": "NotContains", "Expected": ";;" },
          "Severity": 5,