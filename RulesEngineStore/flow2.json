{
   "$schema": "https://kylec69.github.io/schemas/workflow.schema.json",
    "WorkflowName": "EventingParityAndQuery",
    "SchemaVersion": "1.0",
    "Author": "Kyle L Crowder",
    "CreatedOn": "2025-11-22T06:32:00Z",
    "GlobalParameters": {
        "deterministicSeed": 31415,
        "ProviderName": "EventParityProvider",
        "ManifestPath": "C:\\Windows\\System32\\EventParityProvider.man",
        "RegistryKeys": [
            "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\EventParityChannel"
        ],
        "RegisteredProviders": [
            "EventParityProvider"
        ],
        "ChannelNamesFromManifest": [
            "EventParityChannel",
            "EventParityChannel-Verbose"
        ],
        "ChannelNamesFromRegistry": [
            "EventParityChannel"
        ],
        "FileAcl": "",
        "RegistryAcls": "",
        "WevtutilQuery": "*[System/Provider[@Name='EventParityProvider'] and System/Level<=3]",
        "ProbeTimestamp": "2025-11-22T06:32:00Z"
    },
    "Rules": [
        {
            "RuleName": "ManifestDeclaresChannels",
            "ExecutorKey": "ManifestChannelsDeclared",
            "Parameters": {
                "manifestPath": "C:\\Windows\\System32\\EventParityProvider.man",
                "expectedChannels": [
                    "EventParityChannel",
                    "EventParityChannel-Verbose"
                ]
            }
        },
        {
            "RuleName": "RegistryContainsManifestChannels",
            "ExecutorKey": "ManifestChannelsMatchRegistry",
            "Parameters": {
                "manifestChannels": [
                    "EventParityChannel",
                    "EventParityChannel-Verbose"
                ],
                "registryChannelsKeyBase": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels"
            }
        },
        {
            "RuleName": "WevtutilQueryMinResults",
            "ExecutorKey": "WevtutilQueryReturns",
            "Parameters": {
                "query": "*[System/Provider[@Name='EventParityProvider'] and System/Level<=3]",
                "minimumExpectedRecords": 1,
                "timeoutSeconds": 10
            }
        }
    ],
    "ParentWorkflows": [],
    "ChildWorkflows": [],
    "Constraints": {
        "RunSequentially": false,
        "StopOnFailure": false,
        "Timeout": "00:00:30"
    },
    "Results": []
}