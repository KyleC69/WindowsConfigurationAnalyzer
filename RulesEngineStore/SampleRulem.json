{
    "$schema": "https://kylec69.github.io/schemas/workflow.schema.json",
    "WorkflowName": "WindowsSecurityBaseline",
    "SchemaVersion": "1.0",
    "Author": "Kyle L Crowder",
    "CreatedOn": "2025-11-22T12:45:00Z",
    "Constraints": {
        "RunSequentially": true,
        "StopOnFailure": false,
        "Timeout": "00:05:00"
    },
    "Rules": [
        {
            "RuleName": "SmartScreenEnabled",
            "Provider": "Registry",
            "Parameters": {
                "KeyPath": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System",
                "ValueName": "EnableSmartScreen"
            },
            "Condition": {
                "Operator": "Equals",
                "Expected": 1
            },
            "Severity": 5,
            "Message": "SmartScreen must be enabled",
            "Execution": {
                "RunMode": "Independent",
                "Timeout": "00:00:10"
            }
        },
        {
            "RuleName": "FirewallOn",
            "Provider": "WMI",
            "Parameters": {
                "Class": "Win32_Service",
                "Property": "Started",
                "Filter": "Name='MpsSvc'"
            },
            "Condition": {
                "Operator": "Equals",
                "Expected": true
            },
            "Severity": 8,
            "Message": "Windows Firewall service must be running",
            "Execution": {
                "RunMode": "Sequential",
                "StopOnFailure": true
            }
        }
    ]
}